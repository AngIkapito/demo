{% extends 'includes/base.html' %}
{% load static %}
{% block content %}

<div class="row">
    <div class="col-sm-12">
       <div class="card">
          <div class="card-body">
             <form method="post" action="{% url 'profile_update' %}" enctype="multipart/form-data">
                {% csrf_token %}
                   <div class="col-12">
                      <h5 class="form-title"><span>Profile Update</span></h5>
                   </div>

                   {% include 'includes/messages.html' %}

                     <div class="col-sm-11">
                        <div class="form-group">
                            <label>Profile Picture</label>
                            <input type="file" class="form-control" name="profile_pic" id="profilePicInput" accept="image/*" onchange="previewImage(event)">
                            <div class="image-preview text-center" id="imagePreview" style="display: block;">

                              <img id="preview" src="{% static "img/default-profile.png" %}" alt="Image Preview" style="width: 192px; height: 192px; object-fit: cover; margin-top: 10px;border: 2px solid gray; border-radius: 4px;">
                          </div>
                           </div>
                        
                    </div>

                   <div class="col-sm-11">
                      <div class="form-group">
                         <label>Firstname</label>
                         <input type="text" class="form-control" name="first_name" value="{{user.first_name}}" style="text-transform: uppercase;">
                      </div>
                   </div>
                   <div class="col-sm-11">
                      <div class="form-group">
                         <label>Lastname</label>
                         <input type="text" class="form-control" name="last_name" value="{{user.last_name}}" style="text-transform: uppercase;">
                      </div>
                   </div>
                   <div class="col-sm-11">
                    <div class="form-group">
                       <label>Email</label>
                       <input type="text" class="form-control" name="email" value="{{user.email}}" readonly >
                    </div>
                 </div>
                 <div class="col-sm-11">
                    <div class="form-group">
                       <label>Username</label>
                       <input type="text" class="form-control" name="username" value="{{user.username}}" readonly >
                    </div>
                 </div>
                 <div class="col-sm-11">
                    <div class="form-group">
                       <label>Password</label>
                       <input type="password" class="form-control" name="password" placeholder="Fill only if you want to change your password">
                    </div>
                 </div>
                   <div class="col-12">
                      <button type="submit" class="btn btn-primary">Update Profile</button>
                   </div>
             </form>

             
            </div>
          </div>
       </div>
    </div>
 </div>
 <script>
   function previewImage(event) {
       const input = event.target;
       const preview = document.getElementById('preview');
       const imagePreviewContainer = document.getElementById('imagePreview');

       if (input.files && input.files[0]) {
           const reader = new FileReader();

           reader.onload = function(e) {
               preview.src = e.target.result;
           }

           reader.readAsDataURL(input.files[0]); // Convert the file to a data URL
       } else {
           preview.src = "path/to/placeholder-image.jpg"; // Reset to placeholder if no file is selected
       }
   }
</script>
{% endblock %}